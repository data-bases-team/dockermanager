<!--users/templates/users/dashboard.html-->

{% extends 'base.html' %}{% csrf_token %}{% block content %}
<div>
  {% if user.is_authenticated %}
  <a href="{% url 'logout' %}">Logout</a>
  <a href="{% url 'password_change' %}">Change password</a>
  {% else %}
  <a href="{% url 'login' %}">Login</a>
  {% endif %}
  <div class="container">
    <h1>Personal Account Page</h1>
    <hr />
    <h2>Account Information</h2>
    <p><strong>Account Name:</strong> {{ user.username }}</p>
    <p><strong>Email:</strong> {{ user.email }}</p>
    <p><strong>Phone:</strong> 555-555-5555</p>
    {% comment %} точно нужен телефон?? {% endcomment %}
    <hr />
    <h2>Docker Containers</h2>
    <table class="table">
      <thead>
        <tr>
          <th>Container Name</th>
          <th>Start</th>
          <th>Stop</th>
          <th>Expires</th>
          <th>Prolong</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody>
        {%for container in containeros%}
        <tr>
          <td>
            <p>{{container.name}}</p>
          </td>
          <td>
            <button class="btn btn-success" id="run-script-start">Start</button>
          </td>
          <td>
            <button class="btn btn-danger" id="run-script-end">Stop</button>
          </td>
          <td>{{container.expdate}}</td>
          <td>
            <button class="btn btn-primary" id="run-script-prolong">
              Prolong
            </button>
          </td>
          <td>
            <button class="btn btn-danger" id="run-script-delete">
              delete
            </button>
          </td>
        </tr>
        {%endfor%}
        <tr>
          <td><button type="button" class="btn btn-light" id="run-script-new">new</button></td>
        </tr>

        <script>
          const start = document.getElementById("run-script-start");
          start.addEventListener("click", () => {
            fetch("/run_script_start/")
              .then((response) => response.text())
              .then((data) => console.log(data))
              .catch((error) => console.error(error));
          });

          const stop = document.getElementById("run-script-end");
          stop.addEventListener("click", () => {
            fetch("/run_script_end/")
              .then((response) => response.text())
              .then((data) => console.log(data))
              .catch((error) => console.error(error));
          });

          const prolong = document.getElementById("run-script-prolong");

          prolong.addEventListener("click", () => {
            fetch("/run_script_prolong/")
              .then((response) => response.text())
              .then((data) => console.log(data))
              .catch((error) => console.error(error));
            });

            
          const delete = document.getElementById("run-script-delete");

          delete.addEventListener("click", () => {
            fetch("/run_script_delete/")
              .then((response) => response.text())
              .then((data) => console.log(data))
              .catch((error) => console.error(error));
          });

          const new = document.getElementById("run-script-new");

          new.addEventListener("click", () => {
            fetch("/run_script_new/")
              .then((response) => response.text())
              .then((data) => console.log(data))
              .catch((error) => console.error(error));
          });

        </script>
        </tr>
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
